<!--pages/order/order.wxml-->
<view class="container" wx:if="{{order}}">
  <!-- 订单状态 -->
  <view class="order-status-card status-{{order.status}}">
    <view class="status-icon">{{statusIcon}}</view>
    <view class="status-info">
      <text class="status-text">{{order.statusText}}</text>
      <text class="status-desc" wx:if="{{order.statusDesc}}">{{order.statusDesc}}</text>
    </view>
  </view>

  <!-- 产品信息 -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">产品信息</text>
    </view>
    <view class="product-info">
      <image class="product-image" src="{{order.product.coverImage}}" mode="aspectFill"></image>
      <view class="product-detail">
        <text class="product-title">{{order.product.title}}</text>
        <view class="product-meta">
          <text class="product-price">¥{{order.totalAmount}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 订单信息 -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">订单信息</text>
    </view>
    <view class="order-info">
      <view class="info-row">
        <text class="info-label">订单号</text>
        <text class="info-value">{{order.orderNo}}</text>
      </view>
      <view class="info-row">
        <text class="info-label">下单时间</text>
        <text class="info-value">{{order.createdAt}}</text>
      </view>
      <view class="info-row" wx:if="{{order.paidAt}}">
        <text class="info-label">支付时间</text>
        <text class="info-value">{{order.paidAt}}</text>
      </view>
      <view class="info-row" wx:if="{{order.completedAt}}">
        <text class="info-label">完成时间</text>
        <text class="info-value">{{order.completedAt}}</text>
      </view>
    </view>
  </view>

  <!-- 参与人信息 -->
  <view class="card">
    <view class="card-header">
      <text class="card-title">参与人信息</text>
    </view>
    <view class="participant-info">
      <view class="info-row">
        <text class="info-label">姓名</text>
        <text class="info-value">{{order.participantName}}</text>
      </view>
      <view class="info-row">
        <text class="info-label">年龄</text>
        <text class="info-value">{{order.participantAge}}岁</text>
      </view>
      <view class="info-row">
        <text class="info-label">联系方式</text>
        <text class="info-value">{{order.contactPhone}}</text>
      </view>
      <view class="info-row" wx:if="{{order.travelDate}}">
        <text class="info-label">出行日期</text>
        <text class="info-value">{{order.travelDate}}</text>
      </view>
      <view class="info-row" wx:if="{{order.remarks}}">
        <text class="info-label">备注</text>
        <text class="info-value">{{order.remarks}}</text>
      </view>
    </view>
  </view>

  <!-- 底部操作栏 -->
  <view class="bottom-bar" wx:if="{{order.status === 'PENDING' || order.status === 'COMPLETED'}}">
    <button
      class="btn-action btn-cancel"
      wx:if="{{order.status === 'PENDING'}}"
      bindtap="cancelOrder"
    >
      取消订单
    </button>
    <button
      class="btn-action btn-pay"
      wx:if="{{order.status === 'PENDING'}}"
      bindtap="payOrder"
    >
      去支付
    </button>
    <button
      class="btn-action btn-confirm"
      wx:if="{{order.status === 'COMPLETED'}}"
      bindtap="confirmOrder"
    >
      确认完成
    </button>
    <button class="btn-action btn-contact" bindtap="contactService">
      联系客服
    </button>
  </view>
</view>

<!-- 加载中 -->
<view class="loading-container" wx:if="{{loading}}">
  <text>加载中...</text>
</view>
